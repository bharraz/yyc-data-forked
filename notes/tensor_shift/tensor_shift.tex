\documentclass[10pt,fleqn]{article}
% \usepackage[journal=rsc]{chemstyle}
% \usepackage{mhchem}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{esint}
\usepackage{bbm}
\usepackage{amscd}
\usepackage{picinpar}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{tikz-3dplot}
\usepackage{indentfirst}
\usepackage{wrapfig}
\usepackage{units}
\usepackage{textcomp}
\usepackage[utf8x]{inputenc}
% \usepackage{feyn}
% \usepackage{feynmp}
\usepackage{xkeyval}
\usepackage{xargs}
\usepackage{verbatim}
\usepackage{pgfplots}
\usepackage{hyperref}
\usetikzlibrary{
  arrows,
  calc,
  decorations.pathmorphing,
  decorations.pathreplacing,
  decorations.markings,
  fadings,
  positioning,
  shapes
}

\DeclareGraphicsRule{*}{mps}{*}{}
\newcommand{\ud}{\mathrm{d}}
\newcommand{\ue}{\mathrm{e}}
\newcommand{\ui}{\mathrm{i}}
\newcommand{\res}{\mathrm{Res}}
\newcommand{\Tr}{\mathrm{Tr}}
\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\dprod}{\displaystyle\prod}
\newcommand{\dlim}{\displaystyle\lim}
\newcommand{\dint}{\displaystyle\int}
\newcommand{\fsno}[1]{{\!\not\!{#1}}}
\newcommand{\eqar}[1]
{
  \begin{align}
    #1
  \end{align}
}
\newcommand{\texp}[2]{\ensuremath{{#1}\times10^{#2}}}
\newcommand{\dexp}[2]{\ensuremath{{#1}\cdot10^{#2}}}
\newcommand{\eval}[2]{{\left.{#1}\right|_{#2}}}
\newcommand{\paren}[1]{{\left({#1}\right)}}
\newcommand{\lparen}[1]{{\left({#1}\right.}}
\newcommand{\rparen}[1]{{\left.{#1}\right)}}
\newcommand{\abs}[1]{{\left|{#1}\right|}}
\newcommand{\sqr}[1]{{\left[{#1}\right]}}
\newcommand{\crly}[1]{{\left\{{#1}\right\}}}
\newcommand{\angl}[1]{{\left\langle{#1}\right\rangle}}
\newcommand{\tpdiff}[4][{}]{{\paren{\frac{\partial^{#1} {#2}}{\partial {#3}{}^{#1}}}_{#4}}}
\newcommand{\tpsdiff}[4][{}]{{\paren{\frac{\partial^{#1}}{\partial {#3}{}^{#1}}{#2}}_{#4}}}
\newcommand{\pdiff}[3][{}]{{\frac{\partial^{#1} {#2}}{\partial {#3}{}^{#1}}}}
\newcommand{\diff}[3][{}]{{\frac{\ud^{#1} {#2}}{\ud {#3}{}^{#1}}}}
\newcommand{\psdiff}[3][{}]{{\frac{\partial^{#1}}{\partial {#3}{}^{#1}} {#2}}}
\newcommand{\sdiff}[3][{}]{{\frac{\ud^{#1}}{\ud {#3}{}^{#1}} {#2}}}
\newcommand{\tpddiff}[4][{}]{{\left(\dfrac{\partial^{#1} {#2}}{\partial {#3}{}^{#1}}\right)_{#4}}}
\newcommand{\tpsddiff}[4][{}]{{\paren{\dfrac{\partial^{#1}}{\partial {#3}{}^{#1}}{#2}}_{#4}}}
\newcommand{\pddiff}[3][{}]{{\dfrac{\partial^{#1} {#2}}{\partial {#3}{}^{#1}}}}
\newcommand{\ddiff}[3][{}]{{\dfrac{\ud^{#1} {#2}}{\ud {#3}{}^{#1}}}}
\newcommand{\psddiff}[3][{}]{{\frac{\partial^{#1}}{\partial{}^{#1} {#3}} {#2}}}
\newcommand{\sddiff}[3][{}]{{\frac{\ud^{#1}}{\ud {#3}{}^{#1}} {#2}}}
\usepackage{fancyhdr}
\usepackage{multirow}
\usepackage{fontenc}
% \usepackage{tipa}
\usepackage{ulem}
\usepackage{color}
\usepackage{cancel}
\newcommand{\hcancel}[2][black]{\setbox0=\hbox{#2}%
  \rlap{\raisebox{.45\ht0}{\textcolor{#1}{\rule{\wd0}{1pt}}}}#2}
\pagestyle{fancy}
\setlength{\headheight}{67pt}
\fancyhead{}
\fancyfoot{}
\fancyfoot[C]{\thepage}
\fancyhead[R]{}
\renewcommand{\footruleskip}{0pt}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}

\newcommand\pgfmathsinandcos[3]{%
  \pgfmathsetmacro#1{sin(#3)}%
  \pgfmathsetmacro#2{cos(#3)}%
}
\newcommand\LongitudePlane[3][current plane]{%
  \pgfmathsinandcos\sinEl\cosEl{#2} % elevation
  \pgfmathsinandcos\sint\cost{#3} % azimuth
  \tikzset{#1/.estyle={cm={\cost,\sint*\sinEl,0,\cosEl,(0,0)}}}
}
\newcommand\LatitudePlane[3][current plane]{%
  \pgfmathsinandcos\sinEl\cosEl{#2} % elevation
  \pgfmathsinandcos\sint\cost{#3} % latitude
  \pgfmathsetmacro\yshift{\cosEl*\sint}
  \tikzset{#1/.estyle={cm={\cost,0,0,\cost*\sinEl,(0,\yshift)}}} %
}
\newcommand\DrawLongitudeCircle[2][1]{
  \LongitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  % angle of "visibility"
  \pgfmathsetmacro\angVis{atan(sin(#2)*cos(\angEl)/sin(\angEl))} %
  \draw[current plane] (\angVis:1) arc (\angVis:\angVis+180:1);
  \draw[current plane,dashed] (\angVis-180:1) arc (\angVis-180:\angVis:1);
}
\newcommand\DrawLatitudeCircleArrow[2][1]{
  \LatitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  \pgfmathsetmacro\sinVis{sin(#2)/cos(#2)*sin(\angEl)/cos(\angEl)}
  % angle of "visibility"
  \pgfmathsetmacro\angVis{asin(min(1,max(\sinVis,-1)))}
  \draw[current plane,decoration={markings, mark=at position 0.6 with {\arrow{<}}},postaction={decorate},line width=.6mm] (\angVis:1) arc (\angVis:-\angVis-180:1);
  \draw[current plane,dashed,line width=.6mm] (180-\angVis:1) arc (180-\angVis:\angVis:1);
}
\newcommand\DrawLatitudeCircle[2][1]{
  \LatitudePlane{\angEl}{#2}
  \tikzset{current plane/.prefix style={scale=#1}}
  \pgfmathsetmacro\sinVis{sin(#2)/cos(#2)*sin(\angEl)/cos(\angEl)}
  % angle of "visibility"
  \pgfmathsetmacro\angVis{asin(min(1,max(\sinVis,-1)))}
  \draw[current plane] (\angVis:1) arc (\angVis:-\angVis-180:1);
  \draw[current plane,dashed] (180-\angVis:1) arc (180-\angVis:\angVis:1);
}
\newcommand\coil[1]{
  {\rh * cos(\t * pi r)}, {\apart * (2 * #1 + \t) + \rv * sin(\t * pi r)}
}
\makeatletter
\define@key{DrawFromCenter}{style}[{->}]{
  \tikzset{DrawFromCenterPlane/.style={#1}}
}
\define@key{DrawFromCenter}{r}[1]{
  \def\@R{#1}
}
\define@key{DrawFromCenter}{center}[(0, 0)]{
  \def\@Center{#1}
}
\define@key{DrawFromCenter}{theta}[0]{
  \def\@Theta{#1}
}
\define@key{DrawFromCenter}{phi}[0]{
  \def\@Phi{#1}
}
\presetkeys{DrawFromCenter}{style, r, center, theta, phi}{}
\newcommand*\DrawFromCenter[1][]{
  \setkeys{DrawFromCenter}{#1}{
    \pgfmathsinandcos\sint\cost{\@Theta}
    \pgfmathsinandcos\sinp\cosp{\@Phi}
    \pgfmathsinandcos\sinA\cosA{\angEl}
    \pgfmathsetmacro\DX{\@R*\cost*\cosp}
    \pgfmathsetmacro\DY{\@R*(\cost*\sinp*\sinA+\sint*\cosA)}
    \draw[DrawFromCenterPlane] \@Center -- ++(\DX, \DY);
  }
}
\newcommand*\DrawFromCenterText[2][]{
  \setkeys{DrawFromCenter}{#1}{
    \pgfmathsinandcos\sint\cost{\@Theta}
    \pgfmathsinandcos\sinp\cosp{\@Phi}
    \pgfmathsinandcos\sinA\cosA{\angEl}
    \pgfmathsetmacro\DX{\@R*\cost*\cosp}
    \pgfmathsetmacro\DY{\@R*(\cost*\sinp*\sinA+\sint*\cosA)}
    \draw[DrawFromCenterPlane] \@Center -- ++(\DX, \DY) node {#2};
  }
}
\makeatother
\tikzstyle{snakearrow} = [decorate, decoration={pre length=0.2cm,
  post length=0.2cm, snake, amplitude=.4mm,
  segment length=2mm},thick, ->]
%% document-wide tikz options and styles
\tikzset{%
  >=latex, % option for nice arrows
  inner sep=0pt,%
  outer sep=2pt,%
  mark coordinate/.style={inner sep=0pt,outer sep=0pt,minimum size=3pt,
    fill=black,circle}%
}
\addtolength{\hoffset}{-1.3cm}
\addtolength{\voffset}{-2cm}
\addtolength{\textwidth}{3cm}
\addtolength{\textheight}{2.5cm}
\renewcommand{\footskip}{10pt}
\setlength{\headwidth}{\textwidth}
\setlength{\headsep}{20pt}
\setlength{\marginparwidth}{0pt}
\parindent=0pt
\title{Light shift and effective B field}

\ifpdf
  % Ensure reproducible output
  \pdfinfoomitdate=1
  \pdfsuppressptexinfo=-1
  \pdftrailerid{}
  \hypersetup{
    pdfcreator={},
    pdfproducer={}
  }
\fi

\begin{document}

\maketitle

\section{Goal}
Derive and clarify some effects related to vector and tensor light shifts
as well as a few different places they may appear in an experiment.
Most, if not all of the discussion will be limited to E1 transitions.
I'm not really looking for the most mathematically straight forward derivation,
rather trying to see this from different angle for better understanding.

\section[Summary of main results]{Summary of main results\protect\footnote{``Results'' as in ones that are hard to find elsewhere in a form that I like. I'm sure many people have derived/used these before. This does not include standard ones like Wigner-Eckart theorem since it's easy to find reference for it.}}

See the linked sections for the quantitative results.
\begin{enumerate}
\item Section~\ref{stark-shift-explicit} checks the Stark shift's dependency
  on $m_F$ by explicitly compute it using the Clebsch-Gordan coefficients.
  It confirms that {\color{blue}the dependency of the Stark shift on $m_F$
    is at most a second order polynomial} and it has the expected symmetry
  when driven with linear or circular polarized light.
\item Section~\ref{full-effective-explicit} proves that the second order coupling
  between to states $F$ and $F'$ is {\color{blue}proportional to
    the Clebsch-Gordan coefficients $\langle F',m_F'|F,k;m_F,p\rangle$}
  where $k=0,1,2$ denotes scalar, vector and tensor coupling.
\end{enumerate}

\section{Some useful formulas}

\subsection{Spherical component of vector}

Similar to the decomposition of light polarization into $\sigma^\pm$ and $\pi$,
every 3D vector (operator) can be equivalently expressed
as a rank-$1$ spherical tensor,
\eqar{
  \begin{split}
    V_0=&V_z\\
    V_{\pm1}=&\mp\frac{1}{\sqrt2}\paren{V_x\pm\ui V_y}
  \end{split}
}

In particular, when applied to the angular momentum operator,
\eqar{
  \begin{split}
    J_0=&J_z\\
    J_{\pm1}=&\mp\frac{1}{\sqrt2}\paren{J_x\pm\ui J_y}\\
    =&\mp\frac{J_{\pm}}{\sqrt2}
  \end{split}
}
where $J_{\pm}$ are the angular momentum raising and lowering operators.\\

For the complex conjugate of the vector $V^*$, defined as
\eqar{
  (V^*)_{x,y,z}=&V^*_{x,y,z}
}
The spherical components are
\eqar{
  \begin{split}
    (V^*)_0=&V^*_z\\
    (V^*)_{\pm1}=&\mp\frac{1}{\sqrt2}\paren{V^*_x\pm\ui V^*_y}
  \end{split}\label{eq:spherical:conj}
}
Note that in general $(V^*)_{\pm1}\neq V^*_{\pm1}$. In fact,
\eqar{
  \begin{split}
    V^*_{\pm1}=&\mp\frac{1}{\sqrt2}\paren{V^*_x\mp\ui V^*_y}\\
    =&-(V^*)_{\mp1}
  \end{split}\\
  \begin{split}
    V^*_q=&(-1)^q(V^*)_{-q}
  \end{split}
}
i.e. the $+1$ component of $V^*$ is related to the $-1$ component of $V$,
and the $-1$ component of $V^*$ is related to the $+1$ component of $V$.\\

Dot product of two vector
\eqar{
  \begin{split}
    \vec A\cdot\vec B=&\sum_{i=x,y,z}A_iB_i\\
    =&-A_{-1}B_{+1}-A_{+1}B_{-1}+A_0B_0\\
    =&\sum_{q=-1,0,1}(-1)^qA_{q}B_{-q}\\
    =&\sum_{q=-1,0,1}\sqrt{3}\langle 0,0|1,1;q,-q\rangle A_{q}B_{-q}
  \end{split}
}

\subsection{Wigner-Eckart theorem}
This describes the relation between matrix elements of a vector/tensor operator
in the angular momentum basis.
The matrix element for different angular momentum states are related to each other
with Clebsch-Gordan coefficients.
\eqar{
  \langle j,m|T_q^{(k)}|j',m' \rangle=&\langle j',k;m',q|j,m\rangle\langle j||T^{(k)}||j'\rangle
}
where $T_q^{(k)}$ is the $q$-th component of
the spherical tensor operator $T^{(k)}$ of rank $k$.
This is the result of rotation symmetry between all the matrix elements.\\

Equivalently, this also means that no matter what the tensor operator is,
it's matrix elements in this (between these) subspace
differs from that of a different tensor operator only by a constant factor.
(Note that this factor could depend on the $j$ and $j'$ (just not $m$ and $m'$)
and it can of course be $0$ as well), i.e.
\eqar{
  \langle j,m|{T_1}_q^{(k)}|j',m'\rangle\propto&\langle j,m|{T_2}_q^{(k)}|j',m'\rangle
}

\subsection{When $j=j'$}
A special case for the Wigner-Echart theorem is when $j=j'$.
In this case we can plug in the angular momentum operator $J$
(this would otherwise result in vanishing matrix elements if $j\neq j'$
since $J$ conserves, well, $j$).
\eqar{
  \begin{split}
    \langle j,m|J_q|j,m' \rangle=&\langle j,1;m',q|j,m\rangle\langle j||J||j\rangle\\
    \propto&\langle j,1;m',q|j,m\rangle
  \end{split}
}
This allow us to replace the CG coefficents with the angular momentum operator, i.e.,
\eqar{
  \label{eq:jj:prop1}
  \langle j,m|V_q|j,m'\rangle\propto&\langle j,m|J_q|j,m'\rangle
}
which could make some calculation/expression significantly simpler.\\

This relation basically states that within the subspace of a single $j$,
we can treat any vector operator as proportional to the angular momentum.
The proportionality factor can then be obtained from the dot product
with angular momentum, i.e. the projection of the vector onto angular momentum.

\subsubsection{$m=0$ selection rule}
The selection rule for $m=m'=0$ transition directly follows from this relation
since,
\eqar{
  \begin{split}
    \langle j,m|V_0|j,m\rangle\propto&\langle j,m|J_0|j,m\rangle\\
    =&\langle j,m|J_z|j,m\rangle\\
    =&m
  \end{split}
}
which is $0$ when $m=0$.

\subsubsection{Projection theorem}
We can use this to derive the projection theorem.
Explicitly writing down the proportionality factor in Eq. \ref{eq:jj:prop1}, we have,
\eqar{
  \langle j,m|V_q|j,m'\rangle=&c\langle j,m|J_q|j,m'\rangle
}
Multiply both sides with the angular momentum matrix element
and sum over all $m'$ and $q$
\eqar{
  \sum_{m',q}\langle j,m|V_q|j,m'\rangle\langle j,m'|J_q^\dagger|j,m''\rangle=&c\sum_{m',q}\langle j,m|J_q|j,m'\rangle\langle j,m'|J_q^\dagger|j,m''\rangle\\
  \sum_q\langle j,m|V_qV_q^\dagger|j,m''\rangle=&c\sum_q\langle j,m|J_qJ_q^\dagger|j,m''\rangle\\
  \begin{split}
    \langle j,m|(\vec V\cdot \vec J)|j,m''\rangle=&c\langle j,m|J^2|j,m''\rangle\\
    =&c j(j+1)
  \end{split}
}
Therefore we have
\eqar{
  c=&\frac{\langle j,m|(\vec V\cdot \vec J)|j,m''\rangle}{j(j+1)}\\
  \langle j,m|V_q|j,m'\rangle=&\frac{\langle j,m|(\vec V\cdot \vec J)|j,m''\rangle}{j(j+1)}\langle j,m|J_q|j,m'\rangle
}

\subsubsection{Explicit calculation}
Just for completeness, we can verify this relation between angular momentum
and CG coefficients explicitly.
This part can be ignored without affecting the understanding of the rest.

First the expression using angular momentum operators,
\eqar{
  \begin{split}
    \langle j,m|J_0|j,m'\rangle=&\langle j,m|m'|j,m'\rangle\\
    =&m'\delta_{mm'}
  \end{split}\\
  \begin{split}
    \langle j,m|J_{\pm1}|j,m'\rangle=&\mp\frac{1}{\sqrt2}\langle j,m|J_{\pm}|j,m'\rangle\\
    =&\mp\sqrt{\frac{(j\mp m')(j\pm m' + 1)}{2}}\langle j,m|j,m'\pm1\rangle\\
    =&\mp\sqrt{\frac{(j\mp m')(j\pm m' + 1)}{2}}\delta_{m,m'\pm1}
  \end{split}
}

Using the explicit formula for the CG coefficients,
\eqar{
  \begin{split}
    \langle j,1;m',q|j,m\rangle=&\delta_{m,m'+q}\sqrt{\frac{(2j+1)(j+j-1)!(j-j+1)!(j+1-j)!}{(j+1+j+1)!}}\\
                                &\sqrt{(j+m)!(j-m)!(j-m')!(j+m')!(1-q)!(1+q)!}\\
                                &\sum_k\frac{(-1)^k}{k!(j+1-j-k)!(j-m'-k)!(1+q-k)!(j-1+m+k)!(j-j-q+k)!}\\
    =&\delta_{m,m'+q}\frac{\sqrt{(j+m)!(j-m)!(j-m')!(j+m')!(1-q)!(1+q)!}}{2\sqrt{(j+1)j}}\\
                                &\sum_k\frac{(-1)^k}{k!(1-k)!(j-m'-k)!(1+q-k)!(j-1+m'+k)!(-q+k)!}
  \end{split}
}
For $q=0$
\eqar{
  \begin{split}
    \langle j,1;m',0|j,m\rangle=&\delta_{mm'}
                                  \frac{\sqrt{(j+m)!(j-m)!(j-m)!(j+m)!}}{2\sqrt{(j+1)j}}\\
                                &\sum_{k=0,1}\frac{(-1)^k}{k!(1-k)!(j-m-k)!(1-k)!(j-1+m+k)!k!}\\
    =&\delta_{mm'}\frac{(j-m)!(j+m)!}{2\sqrt{(j+1)j}}
       \paren{\frac{1}{(j-m)!(j-1+m)!}-\frac{1}{(j-m-1)!(j+m)!}}\\
    =&m\frac{\delta_{mm'}}{\sqrt{j(j+1)}}
  \end{split}
}
For $q=\pm1$
\eqar{
  \begin{split}
    \langle j,1;m',\pm1|j,m\rangle=&\delta_{m,m'\pm1}\frac{\sqrt{(j+m)!(j-m)!(j-m')!(j+m')!(1\mp1)!(1\pm1)!}}{2\sqrt{(j+1)j}}\\
                                   &\sum_k\frac{(-1)^k}{k!(1-k)!(j-m'-k)!(1\pm1-k)!(j-1+m+k)!(\mp1+k)!}\\
    =&\frac{\delta_{m,m'\pm1}}{\sqrt{(j+1)j}}\sqrt{\frac{(j+m'\pm1)!(j-m'\mp1)!(j-m')!(j+m')!}{2}}\\
                                   &\sum_k\frac{(-1)^k}{k!(1-k)!(j-m'-k)!(1\pm1-k)!(j-1+m'+k)!(\mp1+k)!}
  \end{split}
}
For $q=1$
\eqar{
  \begin{split}
    \langle j,1;m',1|j,m\rangle=&\frac{\delta_{m,m'+1}}{\sqrt{(j+1)j}}\sqrt{\frac{(j+m'+1)!(j-m'-1)!(j-m')!(j+m')!}{2}}\\
                                &\sum_k\frac{(-1)^k}{k!(1-k)!(j-m'-k)!(1+1-k)!(j-1+m'+k)!(-1+k)!}\\
    =&-\frac{\delta_{m,m'+1}}{\sqrt{(j+1)j}}\sqrt{\frac{(j+m'+1)!(j-m'-1)!(j-m')!(j+m')!}{2(j-m'-1)!(j-m'-1)!(j+m')!(j+m')!}}\\
    =&-\sqrt{\frac{(j+m'+1)(j-m')}{2}}\frac{\delta_{m,m'+1}}{\sqrt{(j+1)j}}\\
  \end{split}
}
For $q=-1$
\eqar{
  \begin{split}
    \langle j,1;m',-1|j,m\rangle=&\frac{\delta_{m,m'-1}}{\sqrt{(j+1)j}}\sqrt{\frac{(j+m'-1)!(j-m'+1)!(j-m')!(j+m')!}{2}}\\
                                 &\sum_k\frac{(-1)^k}{k!(1-k)!(j-m'-k)!(-k)!(j-1+m'+k)!(1+k)!}\\
    =&\frac{\delta_{m,m'-1}}{\sqrt{(j+1)j}}\sqrt{\frac{(j+m'-1)!(j-m'+1)!(j-m')!(j+m')!}{2(j-m')!(j-m')!(j+m'-1)!(j+m'-1)!}}\\
    =&\sqrt{\frac{(j-m'+1)(j+m')}{2}}\frac{\delta_{m,m'-1}}{\sqrt{(j+1)j}}
  \end{split}
}
Comparing the result from the two methods,
we can see that the proportionality factor is $\sqrt{(j+1)j}$, or
\eqar{
  \langle j,m|J_q|j,m'\rangle=&\sqrt{(j+1)j}\langle j,1;m',q|j,m\rangle
}


\section{Vector and tensor light shift}
In this section we'll discuss the result of second-order pertubation
on dipole transitions. This includes Raman transitions and Stark shifts.

\subsection{Generic expression}
The effective Hamiltonian from second-order pertubation,
\footnote{Here we've omitted the counter rotating term.
  Including such term will not change the qualitative result of this discussion,
  which only relies on the numerator of each pertubation terms.}
\eqar{
  H_{\mathrm{eff}}=&\sum_{e}\frac{\vec d\cdot\vec E|e\rangle\langle e|\vec d\cdot\vec E^*}{\Delta_e}\\
  =&\paren{\vec E\vec E^*}\cdot\sum_{e}\frac{\vec d|e\rangle\langle e|\vec d}{\Delta_e}
}
Since $H_{\mathrm{eff}}$ is a scalar operator for all possible values of $\vec E$,
the right half of the expression $\sum_{e}\dfrac{\vec d|e\rangle\langle e|\vec d}{\Delta_e}$ must be a rank-2 tensor operator.\\

Therefore, we can always decompose the Hamiltonian into the spherical tensor components
$H^k_q$, where $k=0,1,2$ corresponds to the scalar, vector and tensor parts.
The whole effective Hamiltonian can be written as,
\eqar{
  H_{\mathrm{eff}}=&\sum_{k,p}(-1)^p T^k_{-p}H^k_p
}
where $T^k_p=\dsum_{q,q'}E_q(E^*)_{q'}\langle 1,1;q,q'|k,p\rangle$.
The matrix element would be of the form,
\eqar{
  \begin{split}
    &\langle F,m_F|H_{\mathrm{eff}}|F',m_F'\rangle\\
    =&\sum_{p}(-1)^p T^k_{-p}\langle F,m_F|H^k_p|F',m_F'\rangle\\
    =&\sum_{p}(-1)^p T^k_{-p}\langle F,m_F|H^k_p|F',m_F'\rangle
  \end{split}
}
% TODO

\subsection{Direct derivation}
The coupling between state $|F,m_F\rangle$ and $|F',m_F'\rangle$
\eqar{
  \langle F,m_F|d_{-q}|F',m_F'\rangle=&\langle F||\mathbf{d}||F'\rangle\langle F,m_F|F',1;m_F',-q\rangle\\
  =&\langle F||\mathbf{d}||F'\rangle (-1)^{F'-1+m_F}\sqrt{2F+1}
  \begin{pmatrix}
    F'&1&F\\
    m_F'&-q&m_F
  \end{pmatrix}
}
where $F$ and $m_F$ ($F'$ and $m_F'$) are the total angular momentum and its projection
for the initial (final) state. $d$ is the dipole operator and $q$ is the label
for the spherical harmonic component ($-1$, $0$, or $1$).
$q=\pm1$ corresponds to the $\sigma^\pm$ polarization/transition
and $q=0$ corresponds to the $\pi$ polarization/transition.\\

\subsubsection{Diagonal terms (Stark shifts) only}\label{stark-shift-explicit}
We can first calculate the Stark shift for a pure
($\sigma^+$, $\pi$ or $\sigma^-$) polarization.
This is the case that contains no non-diagonal terms.
We should be able to use this to verify the $m_F$ dependency of the final effect.
(Scalar, vector and tensor shift should corresponds to $0$, $1$ and $2$ order terms
of $m_F$ respectively).\\

Since we only care about the $m_F$ dependency, we can ignore everything that's
$m_F$ independent.\\

The Stark shift,
\eqar{
  \begin{split}
    \Delta E\propto&\langle F,m_F|d_{-q}|F',m_F'\rangle
                     \langle F',m_F'|d_q|F,m_F\rangle\\
    \propto&\abs{\langle F,m_F|F',1;m_F',-q\rangle}^2\\
    \propto&(F+m_F)!(F-m_F)!(F'-m_F-q)!(F'+m_F+q)!\\
                   &\abs{\sum_{k}\frac{(-1)^k}{k!(1\!-\!q\!-\!k)!(F'\!-\!F\!+\!1\!-\!k)!(F\!-\!F'\!+\!q\!+\!k)!(F'\!-\!q\!-\!k\!-\!m_F)!(F\!-\!1\!+\!q\!+\!k\!+\!m_F)!}}^2
  \end{split}
}
The last proportionality relation uses the generic explicit expression for the
Clebsch-Gordan coefficients (ignoring $m_F$ independent factors).
The sum is over all the $k$'s where the factorials are non-negative.
We'll call the last expression $\Delta'(m_F,q)$ in the following part for simplicity.

For $q=-1$
\eqar{
  \begin{split}
    &\Delta'(m_F,-1)\\
    =&(F+m_F)!(F-m_F)!(F'-m_F+1)!(F'+m_F-1)!\\
    &\abs{\sum_{k}\frac{(-1)^k}{k!(2\!-\!k)!(F'\!-\!F\!+\!1\!-\!k)!(F\!-\!F'\!-\!1\!+\!k)!(F'\!+\!1\!-\!k\!-\!m_F)!(F\!-\!2\!+\!k\!+\!m_F)!}}^2
  \end{split}
}
Since we have $F'\!-\!F\!+\!1\!-\!k\geqslant0$ and $F\!-\!F'\!-\!1\!+\!k\geqslant0$, we have $k=F'-F+1$, (with the explicit condition to make sure $F'+m_F-1\geqslant0$)
\eqar{
  \begin{split}
    &\Delta'(m_F,-1)\\
    =&\begin{cases}
      \dfrac{(F+m_F)!(F'-m_F+1)!}{\paren{(F'-F+1)!(F-F'+1)!}^2(F-m_F)!(F'+m_F-1)!}&(m_F\geqslant1-F')\\
      0&(m_F<1-F')
    \end{cases}
  \end{split}
}
To simplify this further, we used the fact that $F'=F-1,F,F+1$
\eqar{
  \begin{split}
    \Delta'(m_F,-1)=&\begin{cases}
      \dfrac{(F+m_F)!(F-m_F)!}{4(F-m_F)!(F+m_F-2)!}&(m_F\geqslant2-F,F'=F-1)\\
      0&(m_F<2-F,F'=F-1)\\
      \dfrac{(F+m_F)!(F-m_F+1)!}{(F-m_F)!(F+m_F-1)!}&(m_F\geqslant1-F,F'=F)\\
      0&(m_F<1-F,F'=F)\\
      \dfrac{(F+m_F)!(F-m_F+2)!}{4(F-m_F)!(F+m_F)!}&(m_F\geqslant1-(F+1),F'=F+1)\\
      0&(m_F<1-(F+1),F'=F+1)
    \end{cases}
  \end{split}\\
  \begin{split}
    \Delta'(m_F,-1)=&\begin{cases}
      \dfrac{(F+m_F)(F+m_F-1)}{4}&(F'=F-1)\\
      (F+m_F)(F-m_F+1)&(F'=F)\\
      \dfrac{(F-m_F+2)(F-m_F+1)}{4}&(F'=F+1)
    \end{cases}
  \end{split}
}
The final simplification uses the fact that $m_F\geqslant F$
and that the expression produces the right value (i.e. $0$) even for out-of-bound $m_F$.

For $q=0$,
\eqar{
  \begin{split}
    &\Delta'(m_F,0)\\
    =&(F+m_F)!(F-m_F)!(F'-m_F)!(F'+m_F)!\\
    &\abs{\sum_{k}\frac{(-1)^k}{k!(1\!-\!k)!(F'\!-\!F\!+\!1\!-\!k)!(F\!-\!F'\!+\!k)!(F'\!-\!k\!-\!m_F)!(F\!-\!1\!+\!k\!+\!m_F)!}}^2
  \end{split}
}
Conditional on the value of $F'$
\eqar{
  \begin{split}
    &\Delta'(m_F,0)\\
    =&\begin{cases}
      \begin{aligned}
        &(F+m_F)!(F-m_F)!(F-1-m_F)!(F-1+m_F)!\\
        &\abs{\sum_{k}\frac{(-1)^k}{k!(1\!-\!k)!(-k)!(1\!+\!k)!(F\!-\!1\!-\!k\!-\!m_F)!(F\!-\!1\!+\!k\!+\!m_F)!}}^2
      \end{aligned}&(F'=F-1)\\
      \begin{aligned}
        &(F+m_F)!(F-m_F)!(F-m_F)!(F+m_F)!\\
        &\abs{\sum_{k}\frac{(-1)^k}{k!(1\!-\!k)!(1\!-\!k)!k!(F\!-\!k\!-\!m_F)!(F\!-\!1\!+\!k\!+\!m_F)!}}^2
      \end{aligned}&(F'=F)\\
      \begin{aligned}
        &(F+m_F)!(F-m_F)!(F'-m_F)!(F'+m_F)!\\
        &\abs{\sum_{k}\frac{(-1)^k}{k!(1\!-\!k)!(2\!-\!k)!(-1\!+\!k)!(F\!+\!1\!-\!k\!-\!m_F)!(F\!-\!1\!+\!k\!+\!m_F)!}}^2
      \end{aligned}&(F'=F+1)
    \end{cases}
  \end{split}
}
For the first and third case, $k$ can only be $0$ and $1$ respectively.
For the second case, $k$ can be either $0$ or $1$ and we need to sum over both.
\eqar{
  \Delta'(m_F,0)=&\begin{cases}
    \dfrac{(F+m_F)!(F-m_F)!(F-1-m_F)!(F-1+m_F)!}{\paren{(F\!-\!1\!-\!m_F)!(F\!-\!1\!+\!m_F)!}^2}&(F'=F-1)\\
    \begin{aligned}
      &(F+m_F)!(F-m_F)!(F-m_F)!(F+m_F)!\\
      &\paren{
        \frac{1}{(F\!-\!m_F)!(F\!-\!1\!+\!m_F)!}
        -\frac{1}{(F\!-\!1\!-\!m_F)!(F\!+\!m_F)!}
        }^2
    \end{aligned}&(F'=F)\\
    \dfrac{(F+m_F)!(F-m_F)!(F+1-m_F)!(F+1+m_F)!}{\paren{(F\!-\!m_F)!(F\!+\!m_F)!}^2}
                                                                                                &(F'=F+1)
  \end{cases}\\
  \Delta'(m_F,0)=&\begin{cases}
    F^2-m_F^2&(F'=F-1)\\
    4m_F^2&(F'=F)\\
    (F+1)^2-m_F^2&(F'=F+1)
  \end{cases}
}

For $q=1$,
\eqar{
  \begin{split}
    &\Delta'(m_F,1)\\
    =&(F+m_F)!(F-m_F)!(F'-m_F-1)!(F'+m_F+1)!\\
    &\abs{\sum_{k}\frac{(-1)^k}{k!(-k)!(F'-F+1-k)!(F-F'+1+k)!(F'-1-k-m_F)!(F+k+m_F)!}}^2
  \end{split}
}
which requires $k=0$,
\eqar{
  \begin{split}
    \Delta'(m_F,1)=&\frac{(F+m_F)!(F-m_F)!(F'-m_F-1)!(F'+m_F+1)!}
                     {\paren{(F'-F+1)!(F-F'+1)!(F'-1-m_F)!(F+m_F)!}^2}\\
    =&\frac{(F-m_F)!(F'+m_F+1)!}{\paren{(F'-F+1)!(F-F'+1)!}^2(F'-m_F-1)!(F+m_F)!}
  \end{split}
}
Here we omitted the check for $F'-m_F-1\geqslant0$ since the final expression
would not depend on it. Conditional on the $F'$ values
\eqar{
  \Delta'(m_F,1)=&\begin{cases}
    \dfrac{(F-m_F)!(F+m_F)!}{4(F-m_F-2)!(F+m_F)!}&(F'=F-1)\\
    \dfrac{(F-m_F)!(F+m_F+1)!}{(F-m_F-1)!(F+m_F)!}&(F'=F)\\
    \dfrac{(F-m_F)!(F+m_F+2)!}{4(F-m_F)!(F+m_F)!}&(F'=F+1)
  \end{cases}\\
  \Delta'(m_F,1)=&\begin{cases}
    \dfrac{(F-m_F)(F-m_F-1)}{4}&(F'=F-1)\\
    (F-m_F)(F+m_F+1)&(F'=F)\\
    \dfrac{(F+m_F+2)(F+m_F+1)}{4}&(F'=F+1)
  \end{cases}
}

We can see that the expressions for $\Delta'(m_F,q)$ are
all second order polynomials of $m_F$. We can also verify that
$\Delta'(-m_F,1)=\Delta'(m_F,-1)$ as required by symmetry.\\

We can also see that for circular polarization ($q=\pm1$) the resulting shift
always have a non-zero linear term. The slope of this term is $\dfrac{1-2F}{4}$, $-1$,
and $\dfrac{2F+3}{4}$ for $\sigma^+$ polarization ($q=1$)
and $F'=F-1,F,F+1$ respectively\footnote{For the $F'=F-1$ expression, $1-2F$ may be $0$ for $F=\dfrac{1}{2}$ but this cannot happen for $F'=F-1$.}.
On the other hand, the expressions for $\pi$ polarization never
have any linear $m_F$ term which is also consistent with symmetry.\\

It is somewhat interesting that the coefficient for the second order terms
are never zero, even for $F=0,\dfrac{1}{2}$ cases where tensor shift does not exist.
Of course since there are not enough ``sampling points'' on the polynomial
the $m_F^2$ term would just appear at most as a global energy shift in such cases.

\subsubsection{Full generic effective Hamiltonian for a single excited state}
\label{full-effective-explicit}
When the polarization of the light is not one of the pure polarizations,
the effect of the second order perturbation would contain off-diagonal terms in addition
to the diagonal ones. In such cases, we would need to calculate the full effective
Hamiltonian matrix instead of only the Stark shifts.\\

Let the amplitude of the light be $A_q$, where $q=-1,0,1$ corresponds to the $\sigma^-$, $\pi$ and $\sigma^+$ polarizations. The matrix element for the effective Hamiltonian is,

\eqar{
  \begin{split}
    &\langle F,m_F|H_{\mathrm{eff}}|F',m_F'\rangle\\
    =&\frac{1}{4\Delta}\sum_{m_F'',q,q'}\langle F,m_F|(-1)^qA_{q}d_{-q}|F'',m_F''\rangle(\langle F',m_F'|(-1)^{q'}A_{q'}d_{-q'}|F'',m_F''\rangle)^*\\
    =&\frac{1}{4\Delta}\sum_{m_F'',q,q'}(-1)^qA_{q}(-1)^{q'}A_{q'}^*\langle F,m_F|d_{-q}|F'',m_F''\rangle(\langle F',m_F'|d_{-q'}|F'',m_F''\rangle)^*\\
    =&\frac{1}{4\Delta}\sum_{m_F'',q,q'}(-1)^qA_{q}(A^*)_{-q'}\langle F,m_F|d_{-q}|F'',m_F''\rangle(\langle F',m_F'|d_{-q'}|F'',m_F''\rangle)^*
  \end{split}
}
where $(A^*)_{q}$ is the spherical component of the complex conjugate of $A$ (ref Eq.~\ref{eq:spherical:conj}). Using Wigner-Echart and the spherical decomposition of rank-2 tensor.

\eqar{
  \begin{split}
    &\langle F,m_F|H_{\mathrm{eff}}|F',m_F'\rangle\\
    =&\frac{\langle F||d||F''\rangle\langle F'||d||F''\rangle^*}{4\Delta}\!\!\sum_{m_F'',q,q'}\!\!(-1)^qA_{q}(A^*)_{-q'}\langle F,m_F|F'',1;m_F'',-q\rangle\langle F'',1;m_F'',-q'|F',m_F'\rangle\\
    =&\frac{\langle F||d||F''\rangle\langle F'||d||F''\rangle^*}{4\Delta}
       \!\sum_{k,p}T_p^k\\
    &\sum_{m_F'',q,q'}\!\!(-1)^q\langle k,p|1,1;q,-q'\rangle
      \langle F,m_F|F'',1;m_F'',-q\rangle\langle F'',1;m_F'',-q'|F',m_F'\rangle
  \end{split}
}
Rewriting in $3-j$ symbol,
\eqar{
  \begin{split}
    &\sum_{m_F'',q,q'}\!\!(-1)^q\langle k,p|1,1;q,-q'\rangle
      \langle F,m_F|F'',1;m_F'',-q\rangle\langle F'',1;m_F'',-q'|F',m_F'\rangle\\
    =&(-1)^{2F''+p-m_F-m_F'}\sqrt{\paren{2k+1}\paren{2F+1}\paren{2F'+1}}\\
    &\sum_{m_F'',q,q'}\!\!(-1)^q\begin{pmatrix}
      1&1&k\\
      q&-q'&-p
    \end{pmatrix}\begin{pmatrix}
      F''&1&F\\
      m_F''&-q&-m_F
    \end{pmatrix}\begin{pmatrix}
      F''&1&F'\\
      m_F''&-q'&-m_F'
    \end{pmatrix}\\
    =&(-1)^{2F''+p-m_F-m_F'}\sqrt{\paren{2k+1}\paren{2F+1}\paren{2F'+1}}\\
    &\sum_{m_F'',q,q'}\!\!(-1)^q\begin{pmatrix}
      1&k&1\\
      q'&-p&-q
    \end{pmatrix}\begin{pmatrix}
      1&F&F''\\
      q&-m_F&-m_F''
    \end{pmatrix}\begin{pmatrix}
      F''&F'&1\\
      m_F''&m_F'&-q'
    \end{pmatrix}\\
    =&(-1)^{F''+m_F-p}\sqrt{\paren{2k+1}\paren{2F+1}\paren{2F'+1}}\\
    &\sum_{m_F'',q,q'}\!\!(-1)^{1+1+F''-q-q'-m_F''}\begin{pmatrix}
      1&k&1\\
      q'&-p&-q
    \end{pmatrix}\begin{pmatrix}
      1&F&F''\\
      q&-m_F&-m_F''
    \end{pmatrix}\begin{pmatrix}
      F''&F'&1\\
      m_F''&m_F'&-q'
    \end{pmatrix}\\
    =&(-1)^{F''+m_F-p}\sqrt{\paren{2k+1}\paren{2F+1}\paren{2F'+1}}
       \begin{pmatrix}
         k&F&F'\\
         p&m_F&-m_F'
       \end{pmatrix}\begin{Bmatrix}
         k&F&F'\\
         F''&1&1
       \end{Bmatrix}\\
    =&(-1)^{F''+F+k}\sqrt{\paren{2k+1}\paren{2F+1}}
       \langle k,F;p,m_F|F',m_F'\rangle\begin{Bmatrix}
         k&F&F'\\
         F''&1&1
       \end{Bmatrix}
  \end{split}
}

For $F'=F$,
\eqar{
  \begin{split}
    &\sum_{m_F'',q,q'}\!\!(-1)^q\langle k,p|1,1;q,-q'\rangle
      \langle F,m_F|F'',1;m_F'',-q\rangle\langle F'',1;m_F'',-q'|F,m_F'\rangle\\
    =&(-1)^{F''+F+k}\sqrt{\paren{2k+1}\paren{2F+1}}
       \langle k,F;p,m_F|F,m_F'\rangle\begin{Bmatrix}
         k&F&F\\
         F''&1&1
       \end{Bmatrix}
  \end{split}
}

% Angular momentum summation/coupling.

\section{Vector light shift as effective magnetic field}

\section{Mitigating the effect of transverse circular polarization in optical tweezers}

% Use effective hamiltonian to explain Raman transitions.

\end{document}
